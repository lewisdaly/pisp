<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2224px" preserveAspectRatio="none" style="width:1595px;height:2224px;" version="1.1" viewBox="0 0 1595 2224" width="1595px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ax8vnsa79a77" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="2179.2227" style="stroke: #A80036; stroke-width: 1.0;" width="779" x="553.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="912.5" y="47.0566">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="359" x="616" y="23.5352">PISP Linking: Credential registration (verification)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="26" x2="26" y1="89.2871" y2="97.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="26" x2="26" y1="97.2871" y2="125.2871"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="26" x2="26" y1="125.2871" y2="164.5977"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="26" x2="26" y1="164.5977" y2="192.5977"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="26" x2="26" y1="192.5977" y2="2172.2227"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="649" x2="649" y1="89.2871" y2="97.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="649" x2="649" y1="97.2871" y2="125.2871"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="649" x2="649" y1="125.2871" y2="164.5977"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="649" x2="649" y1="164.5977" y2="192.5977"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="649" x2="649" y1="192.5977" y2="2172.2227"/><rect fill="#FFFFFF" filter="url(#f1ax8vnsa79a77)" height="166.6406" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="644" y="550.207"/><rect fill="#FFFFFF" filter="url(#f1ax8vnsa79a77)" height="439.3633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="644" y="822"/><rect fill="#FFFFFF" filter="url(#f1ax8vnsa79a77)" height="447.3633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="644" y="1714.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1024" x2="1024" y1="89.2871" y2="97.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1024" x2="1024" y1="97.2871" y2="125.2871"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1024" x2="1024" y1="125.2871" y2="164.5977"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1024" x2="1024" y1="164.5977" y2="192.5977"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1024" x2="1024" y1="192.5977" y2="2172.2227"/><rect fill="#FFFFFF" filter="url(#f1ax8vnsa79a77)" height="163.7734" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1019" y="687.5371"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1277" x2="1277" y1="89.2871" y2="97.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1277" x2="1277" y1="97.2871" y2="125.2871"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1277" x2="1277" y1="125.2871" y2="164.5977"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1277" x2="1277" y1="164.5977" y2="192.5977"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1277" x2="1277" y1="192.5977" y2="2172.2227"/><rect fill="#FFFFFF" filter="url(#f1ax8vnsa79a77)" height="512.1172" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1272" y="1232.0527"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1562" x2="1562" y1="89.2871" y2="97.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1562" x2="1562" y1="97.2871" y2="125.2871"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1562" x2="1562" y1="125.2871" y2="164.5977"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1562" x2="1562" y1="164.5977" y2="192.5977"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1562" x2="1562" y1="192.5977" y2="2172.2227"/><rect fill="#FFFFFF" filter="url(#f1ax8vnsa79a77)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1557" y="2124.9121"/><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="3" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="10" y="74.334">PISP</text><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="557.5" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="564.5" y="74.334">Thirdparty-API-Adapter</text><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="177" x="933.5" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="163" x="940.5" y="74.334">Account Lookup Service</text><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="1225.5" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1232.5" y="74.334">Auth Service</text><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="1536" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1543" y="74.334">DFSP</text><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="3" y="2172.2227"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="10" y="2192.7578">PISP</text><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="557.5" y="2172.2227"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="564.5" y="2192.7578">Thirdparty-API-Adapter</text><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="177" x="933.5" y="2172.2227"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="163" x="940.5" y="2192.7578">Account Lookup Service</text><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="1225.5" y="2172.2227"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1232.5" y="2192.7578">Auth Service</text><rect fill="#FEFECE" filter="url(#f1ax8vnsa79a77)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="1536" y="2172.2227"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1543" y="2192.7578">DFSP</text><path d="M6.5,130.2871 L6.5,155.2871 L1581.5,155.2871 L1581.5,140.2871 L1571.5,130.2871 L6.5,130.2871 " fill="#FBFB77" filter="url(#f1ax8vnsa79a77)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1571.5,130.2871 L1571.5,140.2871 L1581.5,140.2871 L1571.5,130.2871 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="1030" x="272.5" y="147.8555">The PISP uses the FIDO registration flow to generate a new keypair and sign the challenge, relying on the user performing an "unlock action" on their mobile device.</text><polygon fill="#A80036" points="632,546.207,642,550.207,632,554.207,636,550.207" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="26" x2="638" y1="550.207" y2="550.207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="33" y="377.3154">CRED-10</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="99" y="208.6646">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="115" y="223.7974">FSIOP-Source: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="115" y="238.9302">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="254.5645"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="131" y="254.2407">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="269.875"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="131" y="269.5513">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="285.1855"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="131" y="284.8618">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="300.4961"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="131" y="300.1724">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="315.8066"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="147" y="315.4829">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="331.1172"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="163" y="330.7935">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="346.4277"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="147" y="346.104">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="361.7383"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="163" y="361.4146">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="377.0488"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="131" y="376.7251">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="392.3594"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="131" y="392.0356">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="407.6699"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="147" y="407.3462"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="216" x="147" y="407.3462">id: "9876", // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="422.9805"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="147" y="422.6567">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="438.291"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="147" y="437.9673">status: "PENDING",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="453.6016"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="147" y="453.2778">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="468.9121"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="163" y="468.5884">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="484.2227"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="163" y="483.8989"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="312" x="163" y="483.8989">signature: base64(...), // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="499.5332"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="147" y="499.2095">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="514.8438"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="147" y="514.52"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="296" x="147" y="514.52">payload: base64(...), // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="530.1543"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="131" y="529.8306">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="115" y="545.4648"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="115" y="545.1411">}</text><polygon fill="#A80036" points="37,575.5176,27,579.5176,37,583.5176,33,579.5176" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="31" x2="643" y1="579.5176" y2="579.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="43" y="574.7754">CRED-11</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="109" y="574.3628">202 Accepted</text><rect fill="#FFFFFF" filter="url(#f1ax8vnsa79a77)" height="38" style="stroke: #A80036; stroke-width: 1.0;" width="428" x="659" y="592.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="663" y="609.0859">Switch performs account lookup for consentId</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="959" y="608.7622">123</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="320" x="663" y="624.3965">and determines the auth service for this consent is</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="987" y="624.0728">central-auth</text><polygon fill="#A80036" points="1007,683.5371,1017,687.5371,1007,691.5371,1011,687.5371" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="654" x2="1013" y1="687.5371" y2="687.5371"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="661" y="667.751">CRED-12</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="727" y="652.2056">GET /participants/CONSENTS/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="743" y="667.3384">FSIOP-Source: Switch</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="264" x="743" y="682.4712">FSIOP-Destination: Account Lookup</text><polygon fill="#A80036" points="665,712.8477,655,716.8477,665,720.8477,661,716.8477" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="659" x2="1018" y1="716.8477" y2="716.8477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="671" y="712.1055">CRED-13</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="737" y="711.6929">202 Accepted</text><polygon fill="#A80036" points="665,818,655,822,665,826,661,822" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="659" x2="1018" y1="822" y2="822"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="671" y="779.3369">CRED-14</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="737" y="740.9146">PUT /participants/CONSENTS/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="753" y="756.0474">FSIOP-Source: Account Lookup</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="753" y="771.1802">FSIOP-Destination: Switch</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="753" y="786.313">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="801.9473"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="769" y="801.6235">fspId: "central-auth",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="817.2578"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="753" y="816.9341">}</text><polygon fill="#A80036" points="1007,847.3105,1017,851.3105,1007,855.3105,1011,851.3105" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="654" x2="1013" y1="851.3105" y2="851.3105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="661" y="846.5684">CRED-15</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="727" y="846.1558">200 OK</text><polygon fill="#A80036" points="1260,1228.0527,1270,1232.0527,1260,1236.0527,1264,1232.0527" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="654" x2="1266" y1="1232.0527" y2="1232.0527"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="661" y="1051.5947">CRED-16</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="727" y="875.3774">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="743" y="890.5103">FSIOP-Source: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="743" y="905.6431">FSIOP-Destination: central-auth</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="751" y="920.7759">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="936.4102"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="759" y="936.0864">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="951.7207"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="759" y="951.397">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="967.0313"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="759" y="966.7075">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="982.3418"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="759" y="982.0181">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="997.6523"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="775" y="997.3286">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1012.9629"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="791" y="1012.6392">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1028.2734"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="775" y="1027.9497">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1043.584"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="791" y="1043.2603">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1058.8945"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="759" y="1058.5708">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1074.2051"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="759" y="1073.8813">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1089.5156"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="775" y="1089.1919"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="216" x="775" y="1089.1919">id: "9876", // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1104.8262"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="775" y="1104.5024">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1120.1367"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="775" y="1119.813">status: "PENDING",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1135.4473"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="775" y="1135.1235">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1150.7578"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="791" y="1150.4341">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1166.0684"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="791" y="1165.7446"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="312" x="791" y="1165.7446">signature: base64(...), // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1181.3789"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="775" y="1181.0552">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1196.6895"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="775" y="1196.3657"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="296" x="775" y="1196.3657">payload: base64(...), // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1212"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="759" y="1211.6763">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1227.3105"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="743" y="1226.9868">}</text><polygon fill="#A80036" points="665,1257.3633,655,1261.3633,665,1265.3633,661,1261.3633" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="659" x2="1271" y1="1261.3633" y2="1261.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="671" y="1256.6211">CRED-17</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="737" y="1256.2085">202 Accepted</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1282" x2="1324" y1="1305.9844" y2="1305.9844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1324" x2="1324" y1="1305.9844" y2="1318.9844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1283" x2="1324" y1="1318.9844" y2="1318.9844"/><polygon fill="#A80036" points="1293,1314.9844,1283,1318.9844,1293,1322.9844,1289,1318.9844" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1289" y="1293.5869">CRED-18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="1355" y="1285.9316">Verify the signature checks out.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="1355" y="1301.2422">Save the credential.</text><polygon fill="#A80036" points="665,1710.8594,655,1714.8594,665,1718.8594,661,1714.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="659" x2="1271" y1="1714.8594" y2="1714.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="671" y="1526.835">CRED-19</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="737" y="1343.0513">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="753" y="1358.1841">FSIOP-Source: central-auth</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="753" y="1373.3169">FSIOP-Destination: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="753" y="1388.4497">FSIOP-Destination: dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="761" y="1403.5825">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1419.2168"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="769" y="1418.8931">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1434.5273"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="769" y="1434.2036">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1449.8379"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="769" y="1449.5142">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1465.1484"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="769" y="1464.8247">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1480.459"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="785" y="1480.1353">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1495.7695"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="801" y="1495.4458">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1511.0801"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="785" y="1510.7563">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1526.3906"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="801" y="1526.0669">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1541.7012"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="769" y="1541.3774">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1557.0117"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="769" y="1556.688">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1572.3223"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="785" y="1571.9985">id: "9876",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1587.6328"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="785" y="1587.3091">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1602.9434"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="785" y="1602.6196"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="280" x="785" y="1602.6196">status: "VERIFIED", // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1618.2539"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="785" y="1617.9302">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1633.5645"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="801" y="1633.2407">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1648.875"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="801" y="1648.5513">signature: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1664.1855"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="785" y="1663.8618">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1679.4961"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="785" y="1679.1724">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1694.8066"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="769" y="1694.4829">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="1710.1172"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="753" y="1709.7935">}</text><polygon fill="#A80036" points="1260,1740.1699,1270,1744.1699,1260,1748.1699,1264,1744.1699" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="654" x2="1266" y1="1744.1699" y2="1744.1699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="661" y="1739.4277">CRED-20</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="727" y="1739.0151">200 OK</text><polygon fill="#A80036" points="37,2120.9121,27,2124.9121,37,2128.9121,33,2124.9121" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="31" x2="643" y1="2124.9121" y2="2124.9121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="43" y="1944.4541">CRED-21</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="109" y="1768.2368">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="125" y="1783.3696">FSIOP-Source: central-auth</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="125" y="1798.5024">FSIOP-Destination: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="141" y="1813.6353">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1829.2695"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="141" y="1828.9458">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1844.5801"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="141" y="1844.2563">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1859.8906"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="141" y="1859.5669">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1875.2012"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="141" y="1874.8774">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1890.5117"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="157" y="1890.188">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1905.8223"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="173" y="1905.4985">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1921.1328"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="157" y="1920.8091">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1936.4434"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="173" y="1936.1196">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1951.7539"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="141" y="1951.4302">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1967.0645"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="141" y="1966.7407">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1982.375"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="157" y="1982.0513">id: "9876",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="1997.6855"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="157" y="1997.3618">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="2012.9961"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="157" y="2012.6724">status: "VERIFIED",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="2028.3066"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="157" y="2027.9829">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="2043.6172"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="173" y="2043.2935">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="2058.9277"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="173" y="2058.604">signature: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="2074.2383"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="157" y="2073.9146">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="2089.5488"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="157" y="2089.2251">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="2104.8594"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="141" y="2104.5356">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="125" y="2120.1699"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="125" y="2119.8462">}</text><polygon fill="#A80036" points="1545,2120.9121,1555,2124.9121,1545,2128.9121,1549,2124.9121" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="654" x2="1551" y1="2124.9121" y2="2124.9121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="661" y="1944.4541">CRED-22</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="727" y="1768.2368">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="743" y="1783.3696">FSIOP-Source: central-auth</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="743" y="1798.5024">FSIOP-Destination: dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="743" y="1813.6353">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1829.2695"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="759" y="1828.9458">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1844.5801"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="759" y="1844.2563">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1859.8906"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="759" y="1859.5669">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1875.2012"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="759" y="1874.8774">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1890.5117"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="775" y="1890.188">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1905.8223"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="791" y="1905.4985">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1921.1328"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="775" y="1920.8091">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1936.4434"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="791" y="1936.1196">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1951.7539"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="759" y="1951.4302">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1967.0645"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="759" y="1966.7407">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1982.375"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="775" y="1982.0513">id: "9876",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="1997.6855"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="775" y="1997.3618">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="2012.9961"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="775" y="2012.6724">status: "VERIFIED",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="2028.3066"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="775" y="2027.9829">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="2043.6172"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="791" y="2043.2935">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="2058.9277"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="791" y="2058.604">signature: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="2074.2383"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="775" y="2073.9146">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="2089.5488"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="775" y="2089.2251">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="2104.8594"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="759" y="2104.5356">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="743" y="2120.1699"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="743" y="2119.8462">}</text><polygon fill="#A80036" points="632,2150.2227,642,2154.2227,632,2158.2227,636,2154.2227" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="26" x2="638" y1="2154.2227" y2="2154.2227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="33" y="2149.4805">CRED-23</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="99" y="2149.0679">200 OK</text><polygon fill="#A80036" points="665,2150.2227,655,2154.2227,665,2158.2227,661,2154.2227" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="659" x2="1556" y1="2154.2227" y2="2154.2227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="671" y="2149.4805">CRED-24</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="737" y="2149.0679">200 OK</text><!--
@startuml

!pragma teoz true

title PISP Linking: Credential registration (verification)

participant "PISP" as PISP

box "Mojaloop"
    participant "Thirdparty-API-Adapter" as Switch
    participant "Account Lookup Service" as ALS
    participant "Auth Service" as Auth
end box

participant "DFSP" as DFSP

autonumber 10 "<b>CRED-#</b>"

...

note over PISP, DFSP
    The PISP uses the FIDO registration flow to generate a new keypair and sign the challenge, relying on the user performing an "unlock action" on their mobile device.
end note

...

PISP -> Switch ++: ""PUT /consents/123""\n""  FSIOP-Source: pispa""\n""  {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    **id: "9876", // This is new!**""\n    ""    credentialType: "FIDO",""\n    ""    status: "PENDING",""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      **signature: base64(...), // This is new!**""\n    ""    },""\n    ""    **payload: base64(...), // This is new!**""\n    ""  }""\n    ""}""
Switch - -> PISP: ""202 Accepted""
deactivate PISP

rnote right of Switch #Light
    Switch performs account lookup for consentId ""123""
    and determines the auth service for this consent is ""central-auth""
end note

Switch -> ALS ++: ""GET /participants/CONSENTS/123""\n""  FSIOP-Source: Switch""\n""  FSIOP-Destination: Account Lookup""
ALS - -> Switch: ""202 Accepted""
deactivate Switch

ALS -> Switch ++: ""PUT /participants/CONSENTS/123""\n""  FSIOP-Source: Account Lookup""\n""  FSIOP-Destination: Switch""\n""  {""\n    ""  fspId: "central-auth",""\n    ""}""
Switch - -> ALS: ""200 OK""
deactivate ALS


Switch -> Auth ++: ""PUT /consents/123""\n""  FSIOP-Source: pispa""\n""  FSIOP-Destination: central-auth""\n""   {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    **id: "9876", // This is new!**""\n    ""    credentialType: "FIDO",""\n    ""    status: "PENDING",""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      **signature: base64(...), // This is new!**""\n    ""    },""\n    ""    **payload: base64(...), // This is new!**""\n    ""  }""\n    ""}""
Auth - -> Switch: ""202 Accepted""
deactivate Switch

Auth -> Auth: Verify the signature checks out.\nSave the credential.
Auth -> Switch ++: ""PUT /consents/123""\n""  FSIOP-Source: central-auth""\n""  FSIOP-Destination: pispa""\n""  FSIOP-Destination: dfspa""\n""   {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    id: "9876",""\n    ""    credentialType: "FIDO",""\n    ""    **status: "VERIFIED", // This is new!**""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      signature: base64(...),""\n    ""    },""\n    ""    payload: base64(...),""\n    ""  }""\n    ""}""
Switch - -> Auth: ""200 OK""
deactivate Auth

Switch -> PISP ++: ""PUT /consents/123""\n""  FSIOP-Source: central-auth""\n""  FSIOP-Destination: pispa""\n""    {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    id: "9876",""\n    ""    credentialType: "FIDO",""\n    ""    status: "VERIFIED",""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      signature: base64(...),""\n    ""    },""\n    ""    payload: base64(...),""\n    ""  }""\n    ""}""
& Switch -> DFSP ++: ""PUT /consents/123""\n""  FSIOP-Source: central-auth""\n""  FSIOP-Destination: dfspa""\n""  {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    id: "9876",""\n    ""    credentialType: "FIDO",""\n    ""    status: "VERIFIED",""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      signature: base64(...),""\n    ""    },""\n    ""    payload: base64(...),""\n    ""  }""\n    ""}""
PISP - -> Switch - -: ""200 OK""
& DFSP - -> Switch - -: ""200 OK""
deactivate Switch

@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>