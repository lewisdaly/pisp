<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1954px" preserveAspectRatio="none" style="width:1600px;height:1954px;" version="1.1" viewBox="0 0 1600 1954" width="1600px" zoomAndPan="magnify"><defs><filter height="300%" id="fuw0px4l9zgkn" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1907.4297" style="stroke: #A80036; stroke-width: 1.0;" width="718.5" x="616" y="41.1992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="944.75" y="53.7676">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="425" x="585" y="29.4023">PISP Linking: Credential registration (verification)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="28" x2="28" y1="95.998" y2="103.998"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="28" x2="28" y1="103.998" y2="131.998"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="28" x2="28" y1="131.998" y2="171.3086"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="28" x2="28" y1="171.3086" y2="199.3086"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="28" x2="28" y1="199.3086" y2="1907.1406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651" x2="651" y1="95.998" y2="103.998"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="651" x2="651" y1="103.998" y2="131.998"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651" x2="651" y1="131.998" y2="171.3086"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="651" x2="651" y1="171.3086" y2="199.3086"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="651" x2="651" y1="199.3086" y2="1907.1406"/><rect fill="#FFFFFF" filter="url(#fuw0px4l9zgkn)" height="439.3633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="646" y="572.0508"/><rect fill="#FFFFFF" filter="url(#fuw0px4l9zgkn)" height="447.3633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="646" y="1449.7773"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1279" x2="1279" y1="95.998" y2="103.998"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1279" x2="1279" y1="103.998" y2="131.998"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1279" x2="1279" y1="131.998" y2="171.3086"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1279" x2="1279" y1="171.3086" y2="199.3086"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1279" x2="1279" y1="199.3086" y2="1907.1406"/><rect fill="#FFFFFF" filter="url(#fuw0px4l9zgkn)" height="496.9844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1274" y="982.1035"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1564" x2="1564" y1="95.998" y2="103.998"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1564" x2="1564" y1="103.998" y2="131.998"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1564" x2="1564" y1="131.998" y2="171.3086"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1564" x2="1564" y1="171.3086" y2="199.3086"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1564" x2="1564" y1="199.3086" y2="1907.1406"/><rect fill="#FFFFFF" filter="url(#fuw0px4l9zgkn)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1559" y="1859.8301"/><rect fill="#FEFECE" filter="url(#fuw0px4l9zgkn)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="5" y="60.5098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="12" y="81.0449">PISP</text><rect fill="#FEFECE" filter="url(#fuw0px4l9zgkn)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="620" y="60.5098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="627" y="81.0449">Switch</text><rect fill="#FEFECE" filter="url(#fuw0px4l9zgkn)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="1227.5" y="60.5098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1234.5" y="81.0449">Auth Service</text><rect fill="#FEFECE" filter="url(#fuw0px4l9zgkn)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="1538" y="60.5098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1545" y="81.0449">DFSP</text><rect fill="#FEFECE" filter="url(#fuw0px4l9zgkn)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="5" y="1907.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="12" y="1927.6758">PISP</text><rect fill="#FEFECE" filter="url(#fuw0px4l9zgkn)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="620" y="1907.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="627" y="1927.6758">Switch</text><rect fill="#FEFECE" filter="url(#fuw0px4l9zgkn)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="1227.5" y="1907.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1234.5" y="1927.6758">Auth Service</text><rect fill="#FEFECE" filter="url(#fuw0px4l9zgkn)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="1538" y="1907.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1545" y="1927.6758">DFSP</text><path d="M8.5,136.998 L8.5,161.998 L1583.5,161.998 L1583.5,146.998 L1573.5,136.998 L8.5,136.998 " fill="#FBFB77" filter="url(#fuw0px4l9zgkn)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1573.5,136.998 L1573.5,146.998 L1583.5,146.998 L1573.5,136.998 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="1030" x="274.5" y="154.5664">The PISP uses the FIDO registration flow to generate a new keypair and sign the challenge, relying on the user performing an "unlock action" on their mobile device.</text><polygon fill="#A80036" points="634,568.0508,644,572.0508,634,576.0508,638,572.0508" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="28" x2="640" y1="572.0508" y2="572.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="35" y="391.5928">CRED-10</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="101" y="215.3755">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="117" y="230.5083">FSIOP-Source: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="117" y="245.6411">FSIOP-Destination: auth.dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="117" y="260.7739">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="276.4082"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="133" y="276.0845">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="291.7188"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="133" y="291.395">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="307.0293"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="133" y="306.7056">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="322.3398"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="133" y="322.0161">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="337.6504"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="149" y="337.3267">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="352.9609"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="165" y="352.6372">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="368.2715"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="149" y="367.9478">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="383.582"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="165" y="383.2583">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="398.8926"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="133" y="398.5688">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="414.2031"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="133" y="413.8794">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="429.5137"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="149" y="429.1899"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="216" x="149" y="429.1899">id: "9876", // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="444.8242"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="149" y="444.5005">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="460.1348"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="149" y="459.811">status: "PENDING",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="475.4453"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="149" y="475.1216">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="490.7559"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="165" y="490.4321">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="506.0664"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="165" y="505.7427"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="312" x="165" y="505.7427">signature: base64(...), // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="521.377"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="149" y="521.0532">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="536.6875"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="149" y="536.3638"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="296" x="149" y="536.3638">payload: base64(...), // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="551.998"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="133" y="551.6743">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="117" y="567.3086"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="117" y="566.9849">}</text><polygon fill="#A80036" points="39,597.3613,29,601.3613,39,605.3613,35,601.3613" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="33" x2="645" y1="601.3613" y2="601.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="45" y="596.6191">CRED-11</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="111" y="596.2065">202 Accepted</text><polygon fill="#A80036" points="1262,978.1035,1272,982.1035,1262,986.1035,1266,982.1035" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="656" x2="1268" y1="982.1035" y2="982.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="663" y="801.6455">CRED-12</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="729" y="625.4282">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="745" y="640.561">FSIOP-Source: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="745" y="655.6938">FSIOP-Destination: auth.dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="753" y="670.8267">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="686.4609"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="761" y="686.1372">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="701.7715"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="761" y="701.4478">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="717.082"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="761" y="716.7583">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="732.3926"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="761" y="732.0688">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="747.7031"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="777" y="747.3794">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="763.0137"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="793" y="762.6899">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="778.3242"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="777" y="778.0005">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="793.6348"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="793" y="793.311">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="808.9453"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="761" y="808.6216">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="824.2559"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="761" y="823.9321">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="839.5664"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="777" y="839.2427"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="216" x="777" y="839.2427">id: "9876", // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="854.877"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="777" y="854.5532">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="870.1875"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="777" y="869.8638">status: "PENDING",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="885.498"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="777" y="885.1743">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="900.8086"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="793" y="900.4849">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="916.1191"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="793" y="915.7954"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="312" x="793" y="915.7954">signature: base64(...), // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="931.4297"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="777" y="931.106">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="946.7402"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="777" y="946.4165"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="296" x="777" y="946.4165">payload: base64(...), // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="962.0508"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="761" y="961.7271">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="977.3613"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="745" y="977.0376">}</text><polygon fill="#A80036" points="667,1007.4141,657,1011.4141,667,1015.4141,663,1011.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="661" x2="1273" y1="1011.4141" y2="1011.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="673" y="1006.6719">CRED-13</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="739" y="1006.2593">202 Accepted</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1284" x2="1326" y1="1056.0352" y2="1056.0352"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1326" x2="1326" y1="1056.0352" y2="1069.0352"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1285" x2="1326" y1="1069.0352" y2="1069.0352"/><polygon fill="#A80036" points="1295,1065.0352,1285,1069.0352,1295,1073.0352,1291,1069.0352" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1291" y="1043.6377">CRED-14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="1357" y="1035.9824">Verify the signature checks out.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="1357" y="1051.293">Save the credential.</text><polygon fill="#A80036" points="667,1445.7773,657,1449.7773,667,1453.7773,663,1449.7773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="661" x2="1273" y1="1449.7773" y2="1449.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="673" y="1269.3193">CRED-15</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="739" y="1093.1021">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="755" y="1108.2349">FSIOP-Source: auth.dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="755" y="1123.3677">FSIOP-Destination: pisp</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="763" y="1138.5005">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1154.1348"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="771" y="1153.811">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1169.4453"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="771" y="1169.1216">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1184.7559"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="771" y="1184.4321">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1200.0664"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="771" y="1199.7427">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1215.377"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="787" y="1215.0532">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1230.6875"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="803" y="1230.3638">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1245.998"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="787" y="1245.6743">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1261.3086"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="803" y="1260.9849">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1276.6191"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="771" y="1276.2954">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1291.9297"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="771" y="1291.606">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1307.2402"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="787" y="1306.9165">id: "9876",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1322.5508"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="787" y="1322.2271">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1337.8613"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="787" y="1337.5376"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="280" x="787" y="1337.5376">status: "VERIFIED", // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1353.1719"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="787" y="1352.8481">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1368.4824"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="803" y="1368.1587">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1383.793"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="803" y="1383.4692">signature: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1399.1035"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="787" y="1398.7798">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1414.4141"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="787" y="1414.0903">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1429.7246"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="771" y="1429.4009">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="755" y="1445.0352"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="755" y="1444.7114">}</text><polygon fill="#A80036" points="1262,1475.0879,1272,1479.0879,1262,1483.0879,1266,1479.0879" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="656" x2="1268" y1="1479.0879" y2="1479.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="663" y="1474.3457">CRED-16</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="729" y="1473.9331">200 OK</text><polygon fill="#A80036" points="39,1855.8301,29,1859.8301,39,1863.8301,35,1859.8301" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="33" x2="645" y1="1859.8301" y2="1859.8301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="45" y="1679.3721">CRED-17</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="111" y="1503.1548">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="127" y="1518.2876">FSIOP-Source: auth.dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="127" y="1533.4204">FSIOP-Destination: pisp</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="143" y="1548.5532">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1564.1875"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="143" y="1563.8638">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1579.498"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="143" y="1579.1743">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1594.8086"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="143" y="1594.4849">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1610.1191"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="143" y="1609.7954">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1625.4297"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="159" y="1625.106">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1640.7402"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="175" y="1640.4165">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1656.0508"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="159" y="1655.7271">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1671.3613"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="175" y="1671.0376">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1686.6719"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="143" y="1686.3481">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1701.9824"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="143" y="1701.6587">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1717.293"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="159" y="1716.9692">id: "9876",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1732.6035"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="159" y="1732.2798">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1747.9141"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="159" y="1747.5903">status: "VERIFIED",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1763.2246"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="159" y="1762.9009">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1778.5352"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="175" y="1778.2114">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1793.8457"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="175" y="1793.522">signature: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1809.1563"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="159" y="1808.8325">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1824.4668"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="159" y="1824.1431">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1839.7773"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="143" y="1839.4536">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="127" y="1855.0879"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="127" y="1854.7642">}</text><polygon fill="#A80036" points="1547,1855.8301,1557,1859.8301,1547,1863.8301,1551,1859.8301" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="656" x2="1553" y1="1859.8301" y2="1859.8301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="663" y="1679.3721">CRED-18</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="729" y="1503.1548">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="745" y="1518.2876">FSIOP-Source: auth.dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="745" y="1533.4204">FSIOP-Destination: dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="745" y="1548.5532">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1564.1875"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="761" y="1563.8638">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1579.498"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="761" y="1579.1743">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1594.8086"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="761" y="1594.4849">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1610.1191"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="761" y="1609.7954">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1625.4297"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="777" y="1625.106">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1640.7402"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="793" y="1640.4165">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1656.0508"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="777" y="1655.7271">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1671.3613"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="793" y="1671.0376">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1686.6719"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="761" y="1686.3481">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1701.9824"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="761" y="1701.6587">credential: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1717.293"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="777" y="1716.9692">id: "9876",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1732.6035"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="777" y="1732.2798">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1747.9141"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="777" y="1747.5903">status: "VERIFIED",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1763.2246"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="777" y="1762.9009">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1778.5352"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="793" y="1778.2114">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1793.8457"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="793" y="1793.522">signature: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1809.1563"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="777" y="1808.8325">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1824.4668"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="777" y="1824.1431">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1839.7773"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="761" y="1839.4536">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="745" y="1855.0879"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="745" y="1854.7642">}</text><polygon fill="#A80036" points="634,1885.1406,644,1889.1406,634,1893.1406,638,1889.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="28" x2="640" y1="1889.1406" y2="1889.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="35" y="1884.3984">CRED-19</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="101" y="1883.9858">200 OK</text><polygon fill="#A80036" points="667,1885.1406,657,1889.1406,667,1893.1406,663,1889.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="661" x2="1558" y1="1889.1406" y2="1889.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="673" y="1884.3984">CRED-20</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="739" y="1883.9858">200 OK</text><!--MD5=[96025bc7f1f4288bb2284ec159ddf747]
@startuml

!pragma teoz true

title PISP Linking: Credential registration (verification)

participant "PISP" as PISP

box "Mojaloop"
    participant Switch
    participant "Auth Service" as Auth
end box

participant "DFSP" as DFSP

autonumber 10 "<b>CRED-#</b>"

...

note over PISP, DFSP
    The PISP uses the FIDO registration flow to generate a new keypair and sign the challenge, relying on the user performing an "unlock action" on their mobile device.
end note

...

PISP -> Switch ++: ""PUT /consents/123""\n""  FSIOP-Source: pispa""\n""  FSIOP-Destination: auth.dfspa""\n""  {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    **id: "9876", // This is new!**""\n    ""    credentialType: "FIDO",""\n    ""    status: "PENDING",""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      **signature: base64(...), // This is new!**""\n    ""    },""\n    ""    **payload: base64(...), // This is new!**""\n    ""  }""\n    ""}""
Switch - -> PISP: ""202 Accepted""
deactivate PISP

Switch -> Auth ++: ""PUT /consents/123""\n""  FSIOP-Source: pispa""\n""  FSIOP-Destination: auth.dfspa""\n""   {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    **id: "9876", // This is new!**""\n    ""    credentialType: "FIDO",""\n    ""    status: "PENDING",""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      **signature: base64(...), // This is new!**""\n    ""    },""\n    ""    **payload: base64(...), // This is new!**""\n    ""  }""\n    ""}""
Auth - -> Switch: ""202 Accepted""
deactivate Switch

Auth -> Auth: Verify the signature checks out.\nSave the credential.
Auth -> Switch ++: ""PUT /consents/123""\n""  FSIOP-Source: auth.dfspa""\n""  FSIOP-Destination: pisp""\n""   {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    id: "9876",""\n    ""    credentialType: "FIDO",""\n    ""    **status: "VERIFIED", // This is new!**""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      signature: base64(...),""\n    ""    },""\n    ""    payload: base64(...),""\n    ""  }""\n    ""}""
Switch - -> Auth: ""200 OK""
deactivate Auth

Switch -> PISP ++: ""PUT /consents/123""\n""  FSIOP-Source: auth.dfspa""\n""  FSIOP-Destination: pisp""\n""    {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    id: "9876",""\n    ""    credentialType: "FIDO",""\n    ""    status: "VERIFIED",""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      signature: base64(...),""\n    ""    },""\n    ""    payload: base64(...),""\n    ""  }""\n    ""}""
& Switch -> DFSP ++: ""PUT /consents/123""\n""  FSIOP-Source: auth.dfspa""\n""  FSIOP-Destination: dfspa""\n""  {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  credential: {""\n    ""    id: "9876",""\n    ""    credentialType: "FIDO",""\n    ""    status: "VERIFIED",""\n    ""    challenge: {""\n    ""      payload: base64(...),""\n    ""      signature: base64(...),""\n    ""    },""\n    ""    payload: base64(...),""\n    ""  }""\n    ""}""
PISP - -> Switch - -: ""200 OK""
& DFSP - -> Switch - -: ""200 OK""
deactivate Switch

@enduml

PlantUML version 1.2020.18(Thu Oct 01 03:40:44 PHT 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>
