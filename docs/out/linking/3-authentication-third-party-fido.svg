<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="339px" preserveAspectRatio="none" style="width:1003px;height:339px;" version="1.1" viewBox="0 0 1003 339" width="1003px" zoomAndPan="magnify"><defs><filter height="300%" id="f1nyq3pbj9z685" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="435" x="284" y="23.5352">PISP Linking: Authentication (Third-party FIDO registration)</text><rect fill="#DDDDDD" height="293.8398" style="stroke: #A80036; stroke-width: 1.0;" width="70" x="465" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="469.5" y="47.0566">Mojaloop</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="436" x2="436" y1="89.2871" y2="99.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="436" x2="436" y1="99.2871" y2="127.2871"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="436" x2="436" y1="127.2871" y2="181.9082"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="436" x2="436" y1="181.9082" y2="209.9082"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="436" x2="436" y1="209.9082" y2="289.8398"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="500" x2="500" y1="89.2871" y2="99.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="500" x2="500" y1="99.2871" y2="127.2871"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="500" x2="500" y1="127.2871" y2="181.9082"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="500" x2="500" y1="181.9082" y2="209.9082"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="500" x2="500" y1="209.9082" y2="289.8398"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="567" x2="567" y1="89.2871" y2="99.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="567" x2="567" y1="99.2871" y2="127.2871"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="567" x2="567" y1="127.2871" y2="181.9082"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="567" x2="567" y1="181.9082" y2="209.9082"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="567" x2="567" y1="209.9082" y2="289.8398"/><rect fill="#FEFECE" filter="url(#f1nyq3pbj9z685)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="413" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="420" y="74.334">PISP</text><rect fill="#FEFECE" filter="url(#f1nyq3pbj9z685)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="413" y="288.8398"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="420" y="309.375">PISP</text><rect fill="#FEFECE" filter="url(#f1nyq3pbj9z685)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="469" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="476" y="74.334">Switch</text><rect fill="#FEFECE" filter="url(#f1nyq3pbj9z685)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="469" y="288.8398"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="476" y="309.375">Switch</text><rect fill="#FEFECE" filter="url(#f1nyq3pbj9z685)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="541" y="53.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="548" y="74.334">DFSP</text><rect fill="#FEFECE" filter="url(#f1nyq3pbj9z685)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="541" y="288.8398"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="548" y="309.375">DFSP</text><path d="M27,132.2871 L27,172.2871 L971,172.2871 L971,142.2871 L961,132.2871 L27,132.2871 " fill="#FBFB77" filter="url(#f1nyq3pbj9z685)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M961,132.2871 L961,142.2871 L971,142.2871 L961,132.2871 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="476" x="33" y="149.8555">Here the user goes through the web authentication process with their DFSP.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="923" x="33" y="165.166">The end result is a redirect back to the PISP with a special URL parameter indicating to the PISP that it should wait to be notified about a credential.</text><path d="M8,214.9082 L8,269.9082 L991,269.9082 L991,224.9082 L981,214.9082 L8,214.9082 " fill="#FBFB77" filter="url(#f1nyq3pbj9z685)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M981,214.9082 L981,224.9082 L991,224.9082 L981,214.9082 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="962" x="14" y="232.4766">At this point, the DFSP believes that the User is their customer and that User trusts the PISP. This means that the DFSP can continue by granting consent.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="18" y="247.7871"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="802" x="14" y="263.0977">Note that the DFSP never "responds" to the Consent Request itself. Instead, it will create a Consent resource in the Grant phase.</text><!--
@startuml

title PISP Linking: Authentication (Third-party FIDO registration)

participant "PISP" as PISP

box "Mojaloop"
    participant Switch
end box

participant "DFSP" as DFSP

autonumber 1 "<b>3P-FIDO-AUTH-#</b>"

...

note over PISP, DFSP
  Here the user goes through the web authentication process with their DFSP.
  The end result is a redirect back to the PISP with a special URL parameter indicating to the PISP that it should wait to be notified about a credential.
end note

...

autonumber 1 "<b>AUTH-#</b>"

note over PISP, DFSP
  At this point, the DFSP believes that the User is their customer and that User trusts the PISP. This means that the DFSP can continue by granting consent.

  Note that the DFSP never "responds" to the Consent Request itself. Instead, it will create a Consent resource in the Grant phase.
end note

@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 PHT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_171-b11
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>