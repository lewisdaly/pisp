<svg xmlns="http://www.w3.org/2000/svg" height="1478" preserveAspectRatio="none" style="width:1566px;height:1478px" width="1566">
  <defs>
    <filter height="300%" id="a" width="300%" x="-1" y="-1">
      <feGaussianBlur result="blurOut" stdDeviation="2"/>
      <feColorMatrix in="blurOut" result="blurOut2" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
      <feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/>
      <feBlend in="SourceGraphic" in2="blurOut3"/>
    </filter>
  </defs>
  <path fill="#DDD" stroke="#a80036" d="M563 40.953h775v1431.422H563z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="917" y="53.02">
    Mojaloop
  </text>
  <text font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="424" x="568.75" y="28.708">
    PISP Linking: Credential registration (challenge)
  </text>
  <path stroke="#a80036" stroke-dasharray="5,5" d="M29 95.383v1335.695M653 95.383v1335.695"/>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M648 154.781h10v165.93h-10zM648 425.508h10v132.797h-10zM648 977.625h10v435.453h-10z"/>
  <path stroke="#a80036" stroke-dasharray="5,5" d="M1020 95.383v1335.695"/>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M1015 291.578h10v163.063h-10z"/>
  <path stroke="#a80036" stroke-dasharray="5,5" d="M1282 95.383v1335.695"/>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M1277 529.172h10v477.586h-10z"/>
  <path stroke="#a80036" stroke-dasharray="5,5" d="M1529 95.383v1335.695"/>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M5 60.086h44v30.297H5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="12" y="80.081">
    PISP
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M567 60.086h168v30.297H567z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="574" y="80.081">
    Thirdparty-API-Adapter
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M928 60.086h180v30.297H928z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="935" y="80.081">
    Account Lookup Service
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1230 60.086h100v30.297h-100z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="1237" y="80.081">
    Auth Service
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1501.5 60.086h51v30.297h-51z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1508.5" y="80.081">
    DFSP
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M5 1431.078h44v30.297H5z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="12" y="1451.073">
    PISP
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M567 1431.078h168v30.297H567z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="574" y="1451.073">
    Thirdparty-API-Adapter
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M928 1431.078h180v30.297H928z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="935" y="1451.073">
    Account Lookup Service
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1230 1431.078h100v30.297h-100z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="1237" y="1451.073">
    Auth Service
  </text>
  <path fill="#FEFECE" filter="url(#a)" stroke="#a80036" stroke-width="1.5" d="M1501.5 1431.078h51v30.297h-51z"/>
  <text font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1508.5" y="1451.073">
    DFSP
  </text>
  <path fill="#A80036" stroke="#a80036" d="M636 150.781l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M29 154.781h613"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="36" y="134.583">
    CRED-1
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="94" y="119.45">
    POST /consents/123/generateChallenge
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="110" y="134.583">
    FSIOP-Source: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="110" y="149.715">
    {}
  </text>
  <path fill="#A80036" stroke="#a80036" d="M40 179.914l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M34 183.914h613"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="46" y="178.848">
    CRED-2
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="104" y="178.848">
    202 Accepted
  </text>
  <path fill="#FFF" filter="url(#a)" stroke="#a80036" d="M663 196.914h433v38H663z"/>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="291" x="667" y="212.981">
    Switch performs account lookup for consentId
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="962" y="212.981">
    123
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="667" y="228.114">
    and determines the auth service for this consent is
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="996" y="228.114">
    central-auth
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1003 287.578l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M658 291.578h351"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="665" y="271.379">
    CRED-3
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="723" y="256.247">
    GET /participants/CONSENTS/123
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="739" y="271.379">
    FSIOP-Source: Switch
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="264" x="739" y="286.512">
    FSIOP-Destination: Account Lookup
  </text>
  <path fill="#A80036" stroke="#a80036" d="M669 316.71l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M663 320.711h351"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="675" y="315.645">
    CRED-4
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="733" y="315.645">
    202 Accepted
  </text>
  <path fill="#A80036" stroke="#a80036" d="M669 421.508l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M663 425.508h351"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="675" y="382.61">
    CRED-5
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="733" y="344.778">
    PUT /participants/CONSENTS/123
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="749" y="359.911">
    FSIOP-Source: Account Lookup
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="749" y="375.043">
    FSIOP-Destination: Switch
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="749" y="390.176">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="765" y="405.309">
    fspId: &quot;central-auth&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="749" y="420.442">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1003 450.64l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M658 454.641h351"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="665" y="449.575">
    CRED-6
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="723" y="449.575">
    200 OK
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1265 525.172l10 4-10 4 4-4z"/>
  <path stroke="#a80036" d="M658 529.172h613"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="665" y="501.407">
    CRED-7
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="723" y="478.707">
    POST /consents/123/generateChallenge
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="739" y="493.84">
    FSIOP-Source: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="739" y="508.973">
    FSIOP-Destination: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="747" y="524.106">
    {}
  </text>
  <path fill="#A80036" stroke="#a80036" d="M669 554.305l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M663 558.305h613"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="675" y="553.239">
    CRED-8
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="733" y="553.239">
    202 Accepted
  </text>
  <path stroke="#a80036" d="M1287 587.438h42M1329 587.438v13M1288 600.438h41"/>
  <path fill="#A80036" stroke="#a80036" d="M1298 596.438l-10 4 10 4-4-4z"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="1294" y="582.372">
    CRED-9
  </text>
  <text font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="1352" y="582.372">
    Generate a new challenge.
  </text>
  <path fill="#A80036" stroke="#a80036" d="M669 973.625l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M663 977.625h613"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="675" y="798.532">
    CRED-10
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="742" y="624.504">
    PUT /consents/123
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="758" y="639.637">
    FSIOP-Source: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="758" y="654.77">
    FSIOP-Destination: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="758" y="669.903">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="774" y="685.036">
    requestId: &quot;456&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="774" y="700.168">
    initiatorId: &quot;pispa&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="774" y="715.301">
    participantId: &quot;dfspa&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="774" y="730.434">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="790" y="745.567">
    { accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="806" y="760.7">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="790" y="775.832">
    { accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="806" y="790.965">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="774" y="806.098">
    ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="774" y="821.231">
    credential: { // This is new!
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="790" y="836.364">
    id: null,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="400" x="790" y="851.497">
    credentialType: &quot;FIDO&quot;, // TODO: Is this required?
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="790" y="866.629">
    status: &quot;PENDING&quot;,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="790" y="881.762">
    challenge: {
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="806" y="896.895">
    payload: base64(...),
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="806" y="912.028">
    signature: null,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="790" y="927.161">
    },
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="790" y="942.293">
    payload: null,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="774" y="957.426">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="758" y="972.559">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M1265 1002.758l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M658 1006.758h613"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="665" y="1001.692">
    CRED-11
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="732" y="1001.692">
    202 Accepted
  </text>
  <path fill="#A80036" stroke="#a80036" d="M40 1379.945l-10 4 10 4-4-4z"/>
  <path stroke="#a80036" d="M34 1383.945h613"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="46" y="1204.852">
    CRED-12
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="113" y="1030.825">
    PUT /consents/123
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="129" y="1045.957">
    FSIOP-Source: central-auth
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="129" y="1061.09">
    FSIOP-Destination: pispa
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="121" y="1076.223">
    {
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="145" y="1091.356">
    requestId: &quot;456&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="145" y="1106.489">
    initiatorId: &quot;pispa&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="145" y="1121.622">
    participantId: &quot;dfspa&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="145" y="1136.754">
    scopes: [
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="161" y="1151.887">
    { accountId: &quot;dfsp.username.1234&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="177" y="1167.02">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="161" y="1182.153">
    { accountId: &quot;dfsp.username.5678&quot;,
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="177" y="1197.286">
    actions: [ &quot;accounts.transfer&quot;, &quot;accounts.getBalance&quot; ] },
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="145" y="1212.418">
    ],
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="145" y="1227.551">
    credential: { // This is new!
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="161" y="1242.684">
    id: null,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="184" x="161" y="1257.817">
    credentialType: &quot;FIDO&quot;,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="161" y="1272.95">
    status: &quot;PENDING&quot;,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="161" y="1288.082">
    challenge: {
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="177" y="1303.215">
    payload: base64(...),
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="177" y="1318.348">
    signature: null,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="161" y="1333.481">
    },
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="161" y="1348.614">
    payload: null,
  </text>
  <text font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="145" y="1363.747">
    }
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="129" y="1378.879">
    }
  </text>
  <path fill="#A80036" stroke="#a80036" d="M636 1409.078l10 4-10 4 4-4z"/>
  <path stroke="#a80036" stroke-dasharray="2,2" d="M29 1413.078h613"/>
  <text font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="36" y="1408.012">
    CRED-13
  </text>
  <text font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="103" y="1408.012">
    202 Accepted
  </text>
</svg>
