<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1231px" preserveAspectRatio="none" style="width:1536px;height:1231px;" version="1.1" viewBox="0 0 1536 1231" width="1536px" zoomAndPan="magnify"><defs><filter height="300%" id="fghwz9r61hfjj" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1184.3867" style="stroke: #A80036; stroke-width: 1.0;" width="709.5" x="607" y="41.1992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="931.25" y="53.7676">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="411" x="560" y="29.4023">PISP Linking: Credential registration (challenge)</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="28" x2="28" y1="95.998" y2="1184.0977"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="642" x2="642" y1="95.998" y2="1184.0977"/><rect fill="#FFFFFF" filter="url(#fghwz9r61hfjj)" height="133.1523" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="637" y="170.5293"/><rect fill="#FFFFFF" filter="url(#fghwz9r61hfjj)" height="439.3633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="637" y="726.7344"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1261" x2="1261" y1="95.998" y2="1184.0977"/><rect fill="#FFFFFF" filter="url(#fghwz9r61hfjj)" height="481.6738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1256" y="274.3711"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1500" x2="1500" y1="95.998" y2="1184.0977"/><rect fill="#FEFECE" filter="url(#fghwz9r61hfjj)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="5" y="60.5098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="12" y="81.0449">PISP</text><rect fill="#FEFECE" filter="url(#fghwz9r61hfjj)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="611" y="60.5098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="618" y="81.0449">Switch</text><rect fill="#FEFECE" filter="url(#fghwz9r61hfjj)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="1209.5" y="60.5098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1216.5" y="81.0449">Auth Service</text><rect fill="#FEFECE" filter="url(#fghwz9r61hfjj)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="1474" y="60.5098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1481" y="81.0449">DFSP</text><rect fill="#FEFECE" filter="url(#fghwz9r61hfjj)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="5" y="1184.0977"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="12" y="1204.6328">PISP</text><rect fill="#FEFECE" filter="url(#fghwz9r61hfjj)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="611" y="1184.0977"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="618" y="1204.6328">Switch</text><rect fill="#FEFECE" filter="url(#fghwz9r61hfjj)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="1209.5" y="1184.0977"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1216.5" y="1204.6328">Auth Service</text><rect fill="#FEFECE" filter="url(#fghwz9r61hfjj)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="1474" y="1184.0977"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="1481" y="1204.6328">DFSP</text><polygon fill="#A80036" points="625,166.5293,635,170.5293,625,174.5293,629,170.5293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="28" x2="631" y1="170.5293" y2="170.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="35" y="143.1768">CRED-1</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="92" y="120.0649">POST /consents/123/generateChallenge</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="108" y="135.1978">FSIOP-Source: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="108" y="150.3306">FSIOP-Destination: auth.dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="108" y="165.4634">{}</text><polygon fill="#A80036" points="39,195.8398,29,199.8398,39,203.8398,35,199.8398" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="33" x2="636" y1="199.8398" y2="199.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="45" y="195.0977">CRED-2</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="102" y="194.6851">202 Accepted</text><polygon fill="#A80036" points="1244,270.3711,1254,274.3711,1244,278.3711,1248,274.3711" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647" x2="1250" y1="274.3711" y2="274.3711"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="654" y="247.0186">CRED-3</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="711" y="223.9067">POST /consents/123/generateChallenge</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="727" y="239.0396">FSIOP-Source: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="727" y="254.1724">FSIOP-Destination: auth.dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="735" y="269.3052">{}</text><polygon fill="#A80036" points="658,299.6816,648,303.6816,658,307.6816,654,303.6816" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="652" x2="1255" y1="303.6816" y2="303.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="664" y="298.9395">CRED-4</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="721" y="298.5269">202 Accepted</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1266" x2="1308" y1="332.9922" y2="332.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1308" x2="1308" y1="332.9922" y2="345.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1267" x2="1308" y1="345.9922" y2="345.9922"/><polygon fill="#A80036" points="1277,341.9922,1267,345.9922,1277,349.9922,1273,345.9922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="1273" y="328.25">CRED-5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="1330" y="328.25">Generate a new challenge.</text><polygon fill="#A80036" points="658,722.7344,648,726.7344,658,730.7344,654,726.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="652" x2="1255" y1="726.7344" y2="726.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="664" y="546.2764">CRED-6</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="721" y="370.0591">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="737" y="385.1919">FSIOP-Source: auth.dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="737" y="400.3247">FSIOP-Destination: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="737" y="415.4575">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="431.0918"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="753" y="430.7681">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="446.4023"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="753" y="446.0786">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="461.7129"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="753" y="461.3892">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="477.0234"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="753" y="476.6997">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="492.334"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="769" y="492.0103">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="507.6445"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="785" y="507.3208">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="522.9551"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="769" y="522.6313">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="538.2656"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="785" y="537.9419">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="553.5762"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="753" y="553.2524">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="568.8867"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="568.563"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="753" y="568.563">credential: { // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="584.1973"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="769" y="583.8735"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="769" y="583.8735">id: null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="599.5078"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="769" y="599.1841"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="400" x="769" y="599.1841">credentialType: "FIDO", // TODO: Is this required?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="614.8184"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="769" y="614.4946"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="769" y="614.4946">status: "PENDING",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="630.1289"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="769" y="629.8052"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="769" y="629.8052">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="645.4395"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="785" y="645.1157"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="785" y="645.1157">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="660.75"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="785" y="660.4263"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="785" y="660.4263">signature: null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="676.0605"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="769" y="675.7368"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="769" y="675.7368">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="691.3711"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="769" y="691.0474"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="769" y="691.0474">payload: null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="706.6816"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="753" y="706.3579"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="753" y="706.3579">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="737" y="721.9922"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="737" y="721.6685">}</text><polygon fill="#A80036" points="1244,752.0449,1254,756.0449,1244,760.0449,1248,756.0449" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="647" x2="1250" y1="756.0449" y2="756.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="654" y="751.3027">CRED-7</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="711" y="750.8901">202 Accepted</text><polygon fill="#A80036" points="39,1132.7871,29,1136.7871,39,1140.7871,35,1136.7871" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="33" x2="636" y1="1136.7871" y2="1136.7871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="45" y="956.3291">CRED-8</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="102" y="780.1118">PUT /consents/123</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="118" y="795.2446">FSIOP-Source: auth.dfspa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="118" y="810.3774">FSIOP-Destination: pispa</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="110" y="825.5103">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="841.1445"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="134" y="840.8208">requestId: "456",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="856.4551"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="134" y="856.1313">initiatorId: "pispa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="871.7656"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="134" y="871.4419">participantId: "dfspa",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="887.0762"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="134" y="886.7524">scopes: [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="902.3867"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="150" y="902.063">{ accountId: "dfsp.username.1234",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="917.6973"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="166" y="917.3735">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="933.0078"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="150" y="932.6841">{ accountId: "dfsp.username.5678",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="948.3184"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="464" x="166" y="947.9946">actions: [ "accounts.transfer", "accounts.getBalance" ] },</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="963.6289"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="134" y="963.3052">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="978.9395"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="134" y="978.6157"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="232" x="134" y="978.6157">credential: { // This is new!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="994.25"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="150" y="993.9263"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="150" y="993.9263">id: null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="1009.5605"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="150" y="1009.2368"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="184" x="150" y="1009.2368">credentialType: "FIDO",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="1024.8711"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="150" y="1024.5474"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="150" y="1024.5474">status: "PENDING",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="1040.1816"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="150" y="1039.8579"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="150" y="1039.8579">challenge: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="1055.4922"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="166" y="1055.1685"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="166" y="1055.1685">payload: base64(...),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="1070.8027"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="166" y="1070.479"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="166" y="1070.479">signature: null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="1086.1133"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="150" y="1085.7896"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="150" y="1085.7896">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="1101.4238"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="150" y="1101.1001"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="150" y="1101.1001">payload: null,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="1116.7344"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="134" y="1116.4106"/><text fill="#000000" font-family="monospace" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="8" x="134" y="1116.4106">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="118" y="1132.0449"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="118" y="1131.7212">}</text><polygon fill="#A80036" points="625,1162.0977,635,1166.0977,625,1170.0977,629,1166.0977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="28" x2="631" y1="1166.0977" y2="1166.0977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="35" y="1161.3555">CRED-9</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="92" y="1160.9429">202 Accepted</text><!--MD5=[66b9badcf5fe5ddf4bd01b1da3fc484d]
@startuml

!pragma teoz true

title PISP Linking: Credential registration (challenge)

participant "PISP" as PISP

box "Mojaloop"
    participant Switch
    participant "Auth Service" as Auth
end box

participant "DFSP" as DFSP

autonumber 1 "<b>CRED-#</b>"

PISP -> Switch ++: ""POST /consents/123/generateChallenge""\n""  FSIOP-Source: pispa""\n""  FSIOP-Destination: auth.dfspa""\n""  {}""
Switch - -> PISP: ""202 Accepted""
deactivate PISP

Switch -> Auth ++: ""POST /consents/123/generateChallenge""\n""  FSIOP-Source: pispa""\n""  FSIOP-Destination: auth.dfspa""\n""   {}""
Auth - -> Switch: ""202 Accepted""
deactivate Switch

Auth -> Auth: Generate a new challenge.
Auth -> Switch ++: ""PUT /consents/123""\n""  FSIOP-Source: auth.dfspa""\n""  FSIOP-Destination: pispa""\n""  {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  **credential: { // This is new!**""\n    ""    **id: null,**""\n    ""    **credentialType: "FIDO", // TODO: Is this required?**""\n    ""    **status: "PENDING",**""\n    ""    **challenge: {**""\n    ""      **payload: base64(...),**""\n    ""      **signature: null,**""\n    ""    **},**""\n    ""    **payload: null,**""\n    ""  **}**""\n    ""}""
Switch - -> Auth: ""202 Accepted""
deactivate Auth

Switch -> PISP ++: ""PUT /consents/123""\n""  FSIOP-Source: auth.dfspa""\n""  FSIOP-Destination: pispa""\n"" {""\n    ""  requestId: "456",""\n    ""  initiatorId: "pispa",""\n    ""  participantId: "dfspa",""\n    ""  scopes: [ ""\n    ""    { accountId: "dfsp.username.1234",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""    { accountId: "dfsp.username.5678",""\n    ""      actions: [ "accounts.transfer", "accounts.getBalance" ] },""\n    ""  ],""\n    ""  **credential: { // This is new!**""\n    ""    **id: null,**""\n    ""    **credentialType: "FIDO",**""\n    ""    **status: "PENDING",**""\n    ""    **challenge: {**""\n    ""      **payload: base64(...),**""\n    ""      **signature: null,**""\n    ""    **},**""\n    ""    **payload: null,**""\n    ""  **}**""\n    ""}""
PISP - -> Switch: ""202 Accepted""
deactivate Switch

@enduml

PlantUML version 1.2020.18(Thu Oct 01 03:40:44 PHT 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>